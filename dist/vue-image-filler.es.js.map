{"version":3,"file":"vue-image-filler.es.js","sources":["../src/drag-handle.js","../src/Slider.js","../src/image-filler.js","../src/index.js"],"sourcesContent":["// 清除页面选择，阻止浏览器默认事件防止页面抖动\nfunction preventDefault (event) {\n\twindow.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()\n\tevent.preventDefault && event.preventDefault()\n\tevent.stopPropagation && event.stopPropagation()\n}\n// 回调触发器\nfunction stepCall(callback, event, startX, startY) {\n\tif (!callback) {\n\t\treturn\n\t}\n\tlet clientX = event.clientX\n\tlet clientY = event.clientY\n\tlet xOffset = clientX - startX\n\tlet yOffset = clientY - startY\n\n\tcallback({\n\t\tclientX,\n\t\tclientY,\n\t\txOffset,\n\t\tyOffset\n\t})\n}\n\n// 触摸屏逻辑\nfunction touch (event, move, end) {\n\tlet startX = event.touches[0].clientX\n\tlet startY = event.touches[0].clientY\n\tlet lastTouch\n\n\tfunction touchmove(e) {\n\t\tpreventDefault (e)\n\t\tlastTouch = e.touches[0]\n\t\tstepCall(move, lastTouch, startX, startY)\n\t}\n\n\tfunction touchend(e) {\n\t\tevent.target.removeEventListener('touchmove', touchmove, false)\n\t\tevent.target.removeEventListener('touchend', touchend, false)\n\t\tevent.target.removeEventListener('touchcancel', touchend, false)\n\t\tstepCall(end, lastTouch, startX, startY)\n\t}\n\n\tevent.target.addEventListener('touchmove', touchmove, false)\n\tevent.target.addEventListener('touchend', touchend, false)\n\tevent.target.addEventListener('touchcancel', touchend, false)\n}\n// 鼠标逻辑\nfunction mouse (event, move, end) {\n\tlet startX = event.clientX\n\tlet startY = event.clientY\n\n\tfunction mousemove(e) {\n\t\tpreventDefault (e)\n\t\twindow.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()\n\t\tstepCall(move, e, startX, startY)\n\t}\n\n\tfunction mouseup(e) {\n\t\tdocument.removeEventListener('mousemove', mousemove, false)\n\t\tdocument.removeEventListener('mouseup', mouseup, false)\n\t\tstepCall(end, e, startX, startY)\n\t}\n\n\tdocument.addEventListener('mousemove', mousemove, false)\n\tdocument.addEventListener('mouseup', mouseup, false)\n}\n\n// 主逻辑\nfunction dragHandle(event, { move, end }) {\n\tpreventDefault (event)\n\tif (event.type === 'touchstart') {\n\t\ttouch(event, move, end)\n\t} else {\n\t\tmouse(event, move, end)\n\t}\n\n}\nexport default dragHandle","import dragHandle from './drag-handle.js'\r\n\r\nconst Slider = {\r\n\tname: 'image-filler-slider',\r\n\tprops: {\r\n\t\tmin: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 100\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t},\r\n\ttemplate: `<div class=\"vue-image-filler-slider-bar\" ref=\"outer\">\r\n\t\t<div :style=\"{width: (progressLocal * 100) + '%'}\"><i\r\n\t\t\t:class=\"[isDragging ? 'dragging' : '']\"\r\n\t\t\t@mousedown=\"dragHandle\"\r\n\t\t\t@touchstart=\"dragHandle\"\r\n\t\t></i></div>\r\n\t</div>`,\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisDragging: false\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tprogressLocal() {\r\n\t\t\treturn (this.value - this.min) / (this.max - this.min)\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tdragHandle(event) {\r\n\t\t\tconst percentStart = this.progressLocal\r\n\t\t\tconst sliderWidth = this.$refs.outer.clientWidth\r\n\t\t\tthis.isDragging = true\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset }) => {\r\n\t\t\t\t\tlet newPercent = percentStart + (xOffset / sliderWidth)\r\n\t\t\t\t\tnewPercent = Math.max(Math.min(newPercent, 1), 0)\r\n\t\t\t\t\tlet newValue = this.min + newPercent * (this.max - this.min)\r\n\t\t\t\t\tthis.$emit('input', newValue)\r\n\t\t\t\t},\r\n\t\t\t\tend: () => {\r\n\t\t\t\t\tthis.isDragging = false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t}\r\n}\r\n\r\nexport default Slider\r\n","import dragHandle from './drag-handle.js'\r\nimport Slider from './Slider.js'\r\nimport template from './template.html'\r\nimport './style.less'\r\n\r\nfunction getBoxSizePlaceIntoAnotherBox(innerWidth, innerHeight, outerWidth, outerHeight) {\r\n\tif (outerWidth / outerHeight > innerWidth / innerHeight) {\r\n\t\treturn {\r\n\t\t\twidth: outerHeight * innerWidth / innerHeight,\r\n\t\t\theight: outerHeight\r\n\t\t}\r\n\t} else {\r\n\t\treturn {\r\n\t\t\twidth: outerWidth,\r\n\t\t\theight: outerWidth * innerHeight / innerWidth\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar ImageFiller = {\r\n\tname: 'image-filler',\r\n\tcomponents: {\r\n\t\tSlider\r\n\t},\r\n\tprops: {\r\n\t\twidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\theight: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t},\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisFileSelected: false,\r\n\t\t\t_imageNode: null,\r\n\t\t\tsize: {\r\n\t\t\t\t// 缩放配置\r\n\t\t\t\tscaleMin: 0.1,\r\n\t\t\t\tscaleMax: 2,\r\n\t\t\t\tscale: 5,\r\n\t\t\t\t// 画布尺寸\r\n\t\t\t\tcanvasWidth: 0,\r\n\t\t\t\tcanvasHeight: 300,\r\n\t\t\t\t// 剪裁区域视觉尺寸\r\n\t\t\t\tcropWidthInView: 0,\r\n\t\t\t\tcropHeightInView: 0,\r\n\t\t\t\t// 图片原始尺寸\r\n\t\t\t\timageWidth: 0,\r\n\t\t\t\timageHeight: 0,\r\n\t\t\t\t// 偏移尺寸\r\n\t\t\t\toffsetTop: 0,\r\n\t\t\t\toffsetLeft: 0\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcropWidth() {\r\n\t\t\treturn this.width\r\n\t\t},\r\n\t\tcropHeight() {\r\n\t\t\treturn this.height\r\n\t\t},\r\n\t\timageWidthInView() {\r\n\t\t\treturn this.size.imageWidth * this.size.scale\r\n\t\t},\r\n\t\timageHeightInView() {\r\n\t\t\treturn this.size.imageHeight * this.size.scale\r\n\t\t}\r\n\t},\r\n\ttemplate: template,\r\n\twatch: {\r\n\t\t'size.scale'() {\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\t\t\tif (this.size.offsetLeft > offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = offsetLeftRange\r\n\t\t\t} else if (this.size.offsetLeft < -offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = -offsetLeftRange\r\n\t\t\t}\r\n\r\n\t\t\tif (this.size.offsetTop > offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = offsetTopRange\r\n\t\t\t} else if (this.size.offsetTop < -offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = -offsetTopRange\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttriggerFileSelect() {\r\n\t\t\tthis.$refs.uploadInput.dispatchEvent(new MouseEvent('click'))\r\n\t\t},\r\n\t\tfileChangeHandle(event) {\r\n\t\t\tlet file = event.target.files[0]\r\n\t\t\tlet fileBlobURL = window.URL.createObjectURL(new Blob([file]))\r\n\t\t\tlet image = new Image()\r\n\t\t\timage.onload = () => {\r\n\t\t\t\tthis.size.imageWidth = image.width || image.naturalWidth\r\n\t\t\t\tthis.size.imageHeight = image.height || image.naturalHeight\r\n\t\t\t\tthis.size.canvasWidth = this.$refs.outer.clientWidth\r\n\t\t\t\tlet { width, height } = getBoxSizePlaceIntoAnotherBox(this.cropWidth, this.cropHeight, this.size.canvasWidth, this.size.canvasHeight)\r\n\t\t\t\tthis.size.cropWidthInView = width * .8\r\n\t\t\t\tthis.size.cropHeightInView = height * .8\r\n\r\n\t\t\t\tthis.size.scaleMin = Math.max(this.size.cropWidthInView / this.size.imageWidth, this.size.cropHeightInView / this.size.imageHeight)\r\n\t\t\t\t// 最大放大系数限定为三倍\r\n\t\t\t\tthis.size.scaleMax = this.size.scaleMin * 3\r\n\t\t\t\tthis.size.scale = this.size.scaleMin\r\n\t\t\t\tthis.size.offsetTop = 0\r\n\t\t\t\tthis.size.offsetLeft = 0\r\n\r\n\t\t\t\tthis.isFileSelected = true\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.$refs.canvasImage.innerHTML = ''\r\n\t\t\t\t\tthis.$refs.canvasImage.appendChild(image)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\timage.src = fileBlobURL\r\n\r\n\t\t\tthis._imageNode = image\r\n\r\n\t\t\tevent.target.value = ''\r\n\t\t},\r\n\t\tmoveImage(event) {\r\n\t\t\tconst offsetTopStart = this.size.offsetTop\r\n\t\t\tconst offsetLeftStart = this.size.offsetLeft\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset, yOffset }) => {\r\n\t\t\t\t\tlet newOffsetTop = offsetTopStart + yOffset\r\n\t\t\t\t\tlet newOffsetLeft = offsetLeftStart + xOffset\r\n\t\t\t\t\tthis.size.offsetTop = Math.max(Math.min(newOffsetTop, offsetTopRange), -offsetTopRange)\r\n\t\t\t\t\tthis.size.offsetLeft = Math.max(Math.min(newOffsetLeft, offsetLeftRange), -offsetLeftRange)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tupload() {\r\n\t\t\tthis.capture(({ fileBlob, config }) => {\r\n\t\t\t\tlet file = new File([fileBlob], 'capture.jpeg', { type: 'image/jpeg', lastModified: Date.now() })\r\n\t\t\t\tthis.$emit('confirm', {\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tfile,\r\n\t\t\t\t\tconfig\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\t\tcapture(callback) {\r\n\t\t\tlet canvas = document.createElement('canvas')\r\n\t\t\tcanvas.width = this.cropWidth\r\n\t\t\tcanvas.height = this.cropHeight\r\n\t\t\tlet zoomRate = this.cropWidth / this.size.cropWidthInView\r\n\t\t\tlet usedWidth = this.imageWidthInView * zoomRate\r\n\t\t\tlet usedHeight = this.imageHeightInView * zoomRate\r\n\t\t\tlet usedX = ((this.size.cropWidthInView - this.imageWidthInView) / 2 + this.size.offsetLeft) * zoomRate\r\n\t\t\tlet usedY = ((this.size.cropHeightInView - this.imageHeightInView) / 2 + this.size.offsetTop) * zoomRate\r\n\r\n\t\t\tcanvas.getContext('2d').drawImage(this._imageNode, usedX, usedY, usedWidth, usedHeight)\r\n\t\t\tcanvas.toBlob(fileBlob => {\r\n\t\t\t\tcallback && callback({\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tconfig: {\r\n\t\t\t\t\t\tx: 0 - usedX / usedWidth,\r\n\t\t\t\t\t\ty: 0 - usedY / usedHeight,\r\n\t\t\t\t\t\twidth: this.cropWidth / usedWidth,\r\n\t\t\t\t\t\theight: this.cropHeight / usedHeight\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, 'image/jpeg', 0.95)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default ImageFiller\r\n","import ImageFiller from './image-filler.js'\r\n\r\nImageFiller.install = function (Vue) {\r\n\tVue.component('ImageFiller', ImageFiller);\r\n}\r\nexport default ImageFiller\r\n"],"names":["preventDefault","event","window","getSelection","removeAllRanges","document","selection","empty","stopPropagation","stepCall","callback","startX","startY","clientX","clientY","xOffset","yOffset","touch","move","end","touches","lastTouch","touchmove","e","touchend","target","removeEventListener","addEventListener","mouse","mousemove","mouseup","dragHandle","type","Slider","name","props","min","Number","default","max","value","template","data","isDragging","computed","progressLocal","methods","percentStart","sliderWidth","$refs","outer","clientWidth","newPercent","Math","newValue","$emit","getBoxSizePlaceIntoAnotherBox","innerWidth","innerHeight","outerWidth","outerHeight","width","height","ImageFiller","components","isFileSelected","_imageNode","size","scaleMin","scaleMax","scale","canvasWidth","canvasHeight","cropWidthInView","cropHeightInView","imageWidth","imageHeight","offsetTop","offsetLeft","cropWidth","cropHeight","imageWidthInView","imageHeightInView","watch","offsetLeftRange","offsetTopRange","triggerFileSelect","uploadInput","dispatchEvent","MouseEvent","fileChangeHandle","file","files","fileBlobURL","URL","createObjectURL","Blob","image","Image","onload","naturalWidth","naturalHeight","$nextTick","canvasImage","innerHTML","appendChild","src","moveImage","offsetTopStart","offsetLeftStart","newOffsetTop","newOffsetLeft","upload","capture","fileBlob","config","File","lastModified","Date","now","canvas","createElement","zoomRate","usedWidth","usedHeight","usedX","usedY","getContext","drawImage","toBlob","x","y","install","Vue","component"],"mappings":"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"}