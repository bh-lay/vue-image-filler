{"version":3,"file":"vue-image-filler.umd.js","sources":["../src/drag-handle.js","../src/Slider.js","../src/image-filler.js","../src/index.js"],"sourcesContent":["function dragHandle(event, { move, end }) {\n\tlet startX = event.clientX\n\tlet startY = event.clientY\n\n\tevent.preventDefault && event.preventDefault()\n\tevent.stopPropagation && event.stopPropagation()\n\n\tdocument.addEventListener('mousemove', mousemove, false)\n\tdocument.addEventListener('mouseup', up, false)\n\n\tfunction getParam(e) {\n\t\tlet clientX = e.clientX\n\t\tlet clientY = e.clientY\n\t\tlet xOffset = clientX - startX\n\t\tlet yOffset = clientY - startY\n\n\t\treturn {\n\t\t\tclientX,\n\t\t\tclientY,\n\t\t\txOffset,\n\t\t\tyOffset\n\t\t}\n\t}\n\tfunction mousemove(e) {\n\t\te.preventDefault && e.preventDefault()\n\t\te.stopPropagation && e.stopPropagation()\n\t\twindow.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()\n\n\t\tmove && move(getParam(e))\n\t}\n\tfunction up(e) {\n\t\tdocument.removeEventListener('mousemove', mousemove, false)\n\t\tdocument.removeEventListener('mouseup', up, false)\n\n\t\tend && end(getParam(e))\n\t}\n}\nexport default dragHandle","import dragHandle from './drag-handle.js'\r\n\r\nconst Slider = {\r\n\tname: 'image-filler-slider',\r\n\tprops: {\r\n\t\tmin: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 100\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t},\r\n\ttemplate: `<div class=\"vue-image-filler-slider-bar\" ref=\"outer\">\r\n\t\t<div :style=\"{width: (progressLocal * 100) + '%'}\"><i\r\n\t\t\t:class=\"[isDragging ? 'dragging' : '']\"\r\n\t\t\t@mousedown=\"dragHandle\"\r\n\t\t></i></div>\r\n\t</div>`,\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisDragging: false\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tprogressLocal() {\r\n\t\t\treturn (this.value - this.min) / (this.max - this.min)\r\n\t\t}\r\n\t},\r\n\tmounted: function () {\r\n\t},\r\n\twatch: {\r\n\t},\r\n\tmethods: {\r\n\t\tdragHandle(event) {\r\n\t\t\tconst percentStart = this.progressLocal\r\n\t\t\tconst sliderWidth = this.$refs.outer.clientWidth\r\n\t\t\tthis.isDragging = true\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset }) => {\r\n\t\t\t\t\tlet newPercent = percentStart + (xOffset / sliderWidth)\r\n\t\t\t\t\tnewPercent = Math.max(Math.min(newPercent, 1), 0)\r\n\t\t\t\t\tlet newValue = this.min + newPercent * (this.max - this.min)\r\n\t\t\t\t\tthis.$emit('input', newValue)\r\n\t\t\t\t},\r\n\t\t\t\tend: () => {\r\n\t\t\t\t\tthis.isDragging = false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t},\r\n\tbeforeDestroy: function () {\r\n\t}\r\n}\r\n\r\nexport default Slider\r\n","import dragHandle from './drag-handle.js'\r\nimport Slider from './Slider.js'\r\nimport template from './template.html'\r\nimport './style.less'\r\n\r\nfunction getBoxSizePlaceIntoAnotherBox(innerWidth, innerHeight, outerWidth, outerHeight) {\r\n\tif (outerWidth / outerHeight > innerWidth / innerHeight) {\r\n\t\treturn {\r\n\t\t\twidth: outerHeight * innerWidth / innerHeight,\r\n\t\t\theight: outerHeight\r\n\t\t}\r\n\t} else {\r\n\t\treturn {\r\n\t\t\twidth: outerWidth,\r\n\t\t\theight: outerWidth * innerHeight / innerWidth\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar ImageFiller = {\r\n\tname: 'image-filler',\r\n\tcomponents: {\r\n\t\tSlider: Slider\r\n\t},\r\n\tprops: {\r\n\t\twidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\theight: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t},\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisFileSelected: false,\r\n\t\t\t_imageNode: null,\r\n\t\t\tsize: {\r\n\t\t\t\t// 缩放配置\r\n\t\t\t\tscaleMin: 0.1,\r\n\t\t\t\tscaleMax: 2,\r\n\t\t\t\tscale: 5,\r\n\t\t\t\t// 画布尺寸\r\n\t\t\t\tcanvasWidth: 0,\r\n\t\t\t\tcanvasHeight: 300,\r\n\t\t\t\t// 剪裁区域视觉尺寸\r\n\t\t\t\tcropWidthInView: 0,\r\n\t\t\t\tcropHeightInView: 0,\r\n\t\t\t\t// 图片原始尺寸\r\n\t\t\t\timageWidth: 0,\r\n\t\t\t\timageHeight: 0,\r\n\t\t\t\t// 偏移尺寸\r\n\t\t\t\toffsetTop: 0,\r\n\t\t\t\toffsetLeft: 0\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcropWidth() {\r\n\t\t\treturn this.width\r\n\t\t},\r\n\t\tcropHeight() {\r\n\t\t\treturn this.height\r\n\t\t},\r\n\t\timageWidthInView() {\r\n\t\t\treturn this.size.imageWidth * this.size.scale\r\n\t\t},\r\n\t\timageHeightInView() {\r\n\t\t\treturn this.size.imageHeight * this.size.scale\r\n\t\t}\r\n\t},\r\n\ttemplate: template,\r\n\tmounted: function () {\r\n\t},\r\n\twatch: {\r\n\t\t'size.scale'(newValue) {\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\t\t\tif (this.size.offsetLeft > offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = offsetLeftRange\r\n\t\t\t} else if (this.size.offsetLeft < -offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = -offsetLeftRange\r\n\t\t\t}\r\n\r\n\t\t\tif (this.size.offsetTop > offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = offsetTopRange\r\n\t\t\t} else if (this.size.offsetTop < -offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = -offsetTopRange\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttriggerFileSelect() {\r\n\t\t\tthis.$refs.uploadInput.dispatchEvent(new MouseEvent('click'))\r\n\t\t},\r\n\t\tfileChangeHandle(event) {\r\n\t\t\tlet file = event.target.files[0]\r\n\t\t\tlet fileBlobURL = window.URL.createObjectURL(new Blob([file]))\r\n\t\t\tlet image = new Image()\r\n\t\t\timage.onload = () => {\r\n\t\t\t\tthis.size.imageWidth = image.naturalWidth\r\n\t\t\t\tthis.size.imageHeight = image.naturalHeight\r\n\t\t\t\tthis.size.canvasWidth = this.$refs.outer.clientWidth\r\n\t\t\t\tlet { width, height } = getBoxSizePlaceIntoAnotherBox(this.cropWidth, this.cropHeight, this.size.canvasWidth, this.size.canvasHeight)\r\n\t\t\t\tthis.size.cropWidthInView = width * .8\r\n\t\t\t\tthis.size.cropHeightInView = height * .8\r\n\r\n\t\t\t\tthis.size.scaleMin = Math.max(this.size.cropWidthInView / this.size.imageWidth, this.size.cropHeightInView / this.size.imageHeight)\r\n\t\t\t\t// 最大放大系数限定为三倍\r\n\t\t\t\tthis.size.scaleMax = this.size.scaleMin * 3\r\n\t\t\t\tthis.size.scale = this.size.scaleMin\r\n\t\t\t\tthis.size.offsetTop = 0\r\n\t\t\t\tthis.size.offsetLeft = 0\r\n\r\n\t\t\t\tthis.isFileSelected = true\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.$refs.canvasImage.innerHTML = ''\r\n\t\t\t\t\tthis.$refs.canvasImage.appendChild(image)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\timage.src = fileBlobURL\r\n\r\n\t\t\tthis._imageNode = image\r\n\r\n\t\t\tevent.target.value = ''\r\n\t\t},\r\n\t\tmoveImage(event) {\r\n\t\t\tconst offsetTopStart = this.size.offsetTop\r\n\t\t\tconst offsetLeftStart = this.size.offsetLeft\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset, yOffset }) => {\r\n\t\t\t\t\tlet newOffsetTop = offsetTopStart + yOffset\r\n\t\t\t\t\tlet newOffsetLeft = offsetLeftStart + xOffset\r\n\t\t\t\t\tthis.size.offsetTop = Math.max(Math.min(newOffsetTop, offsetTopRange), -offsetTopRange)\r\n\t\t\t\t\tthis.size.offsetLeft = Math.max(Math.min(newOffsetLeft, offsetLeftRange), -offsetLeftRange)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tupload() {\r\n\t\t\tthis.capture(({ fileBlob, config }) => {\r\n\t\t\t\tlet file = new File([fileBlob], 'capture.jpeg', { type: 'image/jpeg', lastModified: Date.now() })\r\n\t\t\t\treturn {\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tfile,\r\n\t\t\t\t\tconfig\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tcapture(callback) {\r\n\t\t\tlet canvas = document.createElement('canvas')\r\n\t\t\tcanvas.width = this.cropWidth\r\n\t\t\tcanvas.height = this.cropHeight\r\n\t\t\tlet zoomRate = this.cropWidth / this.size.cropWidthInView\r\n\t\t\tlet usedWidth = this.imageWidthInView * zoomRate\r\n\t\t\tlet usedHeight = this.imageHeightInView * zoomRate\r\n\t\t\tlet usedX = ((this.size.cropWidthInView - this.imageWidthInView) / 2 + this.size.offsetLeft) * zoomRate\r\n\t\t\tlet usedY = ((this.size.cropHeightInView - this.imageHeightInView) / 2 + this.size.offsetTop) * zoomRate\r\n\r\n\t\t\tcanvas.getContext('2d').drawImage(this._imageNode, usedX, usedY, usedWidth, usedHeight)\r\n\t\t\tcanvas.toBlob(fileBlob => {\r\n\t\t\t\tcallback && callback({\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tconfig: {\r\n\t\t\t\t\t\tx: usedX / usedWidth,\r\n\t\t\t\t\t\ty: usedY / usedHeight,\r\n\t\t\t\t\t\twidth: -this.cropWidth / usedWidth,\r\n\t\t\t\t\t\theight: -this.cropHeight / usedHeight\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, 'image/jpeg', 0.95)\r\n\t\t}\r\n\t},\r\n\tbeforeDestroy: function () {\r\n\t}\r\n}\r\n\r\nexport default ImageFiller\r\n","import ImageFiller from './image-filler.js'\r\n\r\nImageFiller.install = function (Vue) {\r\n\tVue.component('ImageFiller', ImageFiller);\r\n}\r\nexport default ImageFiller\r\n"],"names":["dragHandle","event","move","end","startX","clientX","startY","clientY","preventDefault","stopPropagation","document","addEventListener","mousemove","up","getParam","e","xOffset","yOffset","window","getSelection","removeAllRanges","selection","empty","removeEventListener","Slider","name","props","min","type","Number","default","max","value","template","data","isDragging","computed","progressLocal","mounted","watch","methods","percentStart","sliderWidth","$refs","outer","clientWidth","newPercent","Math","newValue","$emit","beforeDestroy","getBoxSizePlaceIntoAnotherBox","innerWidth","innerHeight","outerWidth","outerHeight","width","height","ImageFiller","components","isFileSelected","_imageNode","size","scaleMin","scaleMax","scale","canvasWidth","canvasHeight","cropWidthInView","cropHeightInView","imageWidth","imageHeight","offsetTop","offsetLeft","cropWidth","cropHeight","imageWidthInView","imageHeightInView","offsetLeftRange","offsetTopRange","triggerFileSelect","uploadInput","dispatchEvent","MouseEvent","fileChangeHandle","file","target","files","fileBlobURL","URL","createObjectURL","Blob","image","Image","onload","naturalWidth","naturalHeight","$nextTick","canvasImage","innerHTML","appendChild","src","moveImage","offsetTopStart","offsetLeftStart","newOffsetTop","newOffsetLeft","upload","capture","fileBlob","config","File","lastModified","Date","now","callback","canvas","createElement","zoomRate","usedWidth","usedHeight","usedX","usedY","getContext","drawImage","toBlob","x","y","install","Vue","component"],"mappings":"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"}