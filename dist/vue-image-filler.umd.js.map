{"version":3,"file":"vue-image-filler.umd.js","sources":["../src/drag-handle.js","../src/Slider.js","../src/image-filler.js","../src/index.js"],"sourcesContent":["// 清除页面选择，组织浏览器默认事件防止页面抖动\nfunction preventDefault (event) {\n\twindow.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()\n\tevent.preventDefault && event.preventDefault()\n\tevent.stopPropagation && event.stopPropagation()\n}\n// 回调触发器\nfunction stepCall(callback, event, startX, startY) {\n\tif (!callback) {\n\t\treturn\n\t}\n\tlet clientX = event.clientX\n\tlet clientY = event.clientY\n\tlet xOffset = clientX - startX\n\tlet yOffset = clientY - startY\n\n\tcallback({\n\t\tclientX,\n\t\tclientY,\n\t\txOffset,\n\t\tyOffset\n\t})\n}\n\n// 触摸屏逻辑\nfunction touch (event, move, end) {\n\tlet startX = event.touches[0].clientX\n\tlet startY = event.touches[0].clientY\n\tlet lastTouch\n\n\tfunction touchmove(e) {\n\t\tpreventDefault (e)\n\t\tlastTouch = e.touches[0]\n\t\tstepCall(move, lastTouch, startX, startY)\n\t}\n\n\tfunction touchend(e) {\n\t\tevent.target.removeEventListener('touchmove', touchmove, false)\n\t\tevent.target.removeEventListener('touchend', touchend, false)\n\t\tevent.target.removeEventListener('touchcancel', touchend, false)\n\t\tstepCall(end, lastTouch, startX, startY)\n\t}\n\n\tevent.target.addEventListener('touchmove', touchmove, false)\n\tevent.target.addEventListener('touchend', touchend, false)\n\tevent.target.addEventListener('touchcancel', touchend, false)\n}\n// 鼠标逻辑\nfunction mouse (event, move, end) {\n\tlet startX = event.clientX\n\tlet startY = event.clientY\n\n\tfunction mousemove(e) {\n\t\tpreventDefault (e)\n\t\twindow.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()\n\t\tstepCall(move, e, startX, startY)\n\t}\n\n\tfunction mouseup(e) {\n\t\tdocument.removeEventListener('mousemove', mousemove, false)\n\t\tdocument.removeEventListener('mouseup', mouseup, false)\n\t\tstepCall(end, e, startX, startY)\n\t}\n\n\tdocument.addEventListener('mousemove', mousemove, false)\n\tdocument.addEventListener('mouseup', mouseup, false)\n}\n\n// 主逻辑\nfunction dragHandle(event, { move, end }) {\n\tpreventDefault (event)\n\tif (event.type === 'touchstart') {\n\t\ttouch(event, move, end)\n\t} else {\n\t\tmouse(event, move, end)\n\t}\n\n}\nexport default dragHandle","import dragHandle from './drag-handle.js'\r\n\r\nconst Slider = {\r\n\tname: 'image-filler-slider',\r\n\tprops: {\r\n\t\tmin: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 100\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t},\r\n\ttemplate: `<div class=\"vue-image-filler-slider-bar\" ref=\"outer\">\r\n\t\t<div :style=\"{width: (progressLocal * 100) + '%'}\"><i\r\n\t\t\t:class=\"[isDragging ? 'dragging' : '']\"\r\n\t\t\t@mousedown=\"dragHandle\"\r\n\t\t\t@touchstart=\"dragHandle\"\r\n\t\t></i></div>\r\n\t</div>`,\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisDragging: false\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tprogressLocal() {\r\n\t\t\treturn (this.value - this.min) / (this.max - this.min)\r\n\t\t}\r\n\t},\r\n\tmounted: function () {\r\n\t},\r\n\twatch: {\r\n\t},\r\n\tmethods: {\r\n\t\tdragHandle(event) {\r\n\t\t\tconst percentStart = this.progressLocal\r\n\t\t\tconst sliderWidth = this.$refs.outer.clientWidth\r\n\t\t\tthis.isDragging = true\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset }) => {\r\n\t\t\t\t\tlet newPercent = percentStart + (xOffset / sliderWidth)\r\n\t\t\t\t\tnewPercent = Math.max(Math.min(newPercent, 1), 0)\r\n\t\t\t\t\tlet newValue = this.min + newPercent * (this.max - this.min)\r\n\t\t\t\t\tthis.$emit('input', newValue)\r\n\t\t\t\t},\r\n\t\t\t\tend: () => {\r\n\t\t\t\t\tthis.isDragging = false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t},\r\n\tbeforeDestroy: function () {\r\n\t}\r\n}\r\n\r\nexport default Slider\r\n","import dragHandle from './drag-handle.js'\r\nimport Slider from './Slider.js'\r\nimport template from './template.html'\r\nimport './style.less'\r\n\r\nfunction getBoxSizePlaceIntoAnotherBox(innerWidth, innerHeight, outerWidth, outerHeight) {\r\n\tif (outerWidth / outerHeight > innerWidth / innerHeight) {\r\n\t\treturn {\r\n\t\t\twidth: outerHeight * innerWidth / innerHeight,\r\n\t\t\theight: outerHeight\r\n\t\t}\r\n\t} else {\r\n\t\treturn {\r\n\t\t\twidth: outerWidth,\r\n\t\t\theight: outerWidth * innerHeight / innerWidth\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar ImageFiller = {\r\n\tname: 'image-filler',\r\n\tcomponents: {\r\n\t\tSlider: Slider\r\n\t},\r\n\tprops: {\r\n\t\twidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\theight: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t},\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tisFileSelected: false,\r\n\t\t\t_imageNode: null,\r\n\t\t\tsize: {\r\n\t\t\t\t// 缩放配置\r\n\t\t\t\tscaleMin: 0.1,\r\n\t\t\t\tscaleMax: 2,\r\n\t\t\t\tscale: 5,\r\n\t\t\t\t// 画布尺寸\r\n\t\t\t\tcanvasWidth: 0,\r\n\t\t\t\tcanvasHeight: 300,\r\n\t\t\t\t// 剪裁区域视觉尺寸\r\n\t\t\t\tcropWidthInView: 0,\r\n\t\t\t\tcropHeightInView: 0,\r\n\t\t\t\t// 图片原始尺寸\r\n\t\t\t\timageWidth: 0,\r\n\t\t\t\timageHeight: 0,\r\n\t\t\t\t// 偏移尺寸\r\n\t\t\t\toffsetTop: 0,\r\n\t\t\t\toffsetLeft: 0\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcropWidth() {\r\n\t\t\treturn this.width\r\n\t\t},\r\n\t\tcropHeight() {\r\n\t\t\treturn this.height\r\n\t\t},\r\n\t\timageWidthInView() {\r\n\t\t\treturn this.size.imageWidth * this.size.scale\r\n\t\t},\r\n\t\timageHeightInView() {\r\n\t\t\treturn this.size.imageHeight * this.size.scale\r\n\t\t}\r\n\t},\r\n\ttemplate: template,\r\n\tmounted: function () {\r\n\t},\r\n\twatch: {\r\n\t\t'size.scale'(newValue) {\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\t\t\tif (this.size.offsetLeft > offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = offsetLeftRange\r\n\t\t\t} else if (this.size.offsetLeft < -offsetLeftRange) {\r\n\t\t\t\tthis.size.offsetLeft = -offsetLeftRange\r\n\t\t\t}\r\n\r\n\t\t\tif (this.size.offsetTop > offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = offsetTopRange\r\n\t\t\t} else if (this.size.offsetTop < -offsetTopRange) {\r\n\t\t\t\tthis.size.offsetTop = -offsetTopRange\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttriggerFileSelect() {\r\n\t\t\tthis.$refs.uploadInput.dispatchEvent(new MouseEvent('click'))\r\n\t\t},\r\n\t\tfileChangeHandle(event) {\r\n\t\t\tlet file = event.target.files[0]\r\n\t\t\tlet fileBlobURL = window.URL.createObjectURL(new Blob([file]))\r\n\t\t\tlet image = new Image()\r\n\t\t\timage.onload = () => {\r\n\t\t\t\tthis.size.imageWidth = image.width || image.naturalWidth\r\n\t\t\t\tthis.size.imageHeight = image.height || image.naturalHeight\r\n\t\t\t\tthis.size.canvasWidth = this.$refs.outer.clientWidth\r\n\t\t\t\tlet { width, height } = getBoxSizePlaceIntoAnotherBox(this.cropWidth, this.cropHeight, this.size.canvasWidth, this.size.canvasHeight)\r\n\t\t\t\tthis.size.cropWidthInView = width * .8\r\n\t\t\t\tthis.size.cropHeightInView = height * .8\r\n\r\n\t\t\t\tthis.size.scaleMin = Math.max(this.size.cropWidthInView / this.size.imageWidth, this.size.cropHeightInView / this.size.imageHeight)\r\n\t\t\t\t// 最大放大系数限定为三倍\r\n\t\t\t\tthis.size.scaleMax = this.size.scaleMin * 3\r\n\t\t\t\tthis.size.scale = this.size.scaleMin\r\n\t\t\t\tthis.size.offsetTop = 0\r\n\t\t\t\tthis.size.offsetLeft = 0\r\n\r\n\t\t\t\tthis.isFileSelected = true\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.$refs.canvasImage.innerHTML = ''\r\n\t\t\t\t\tthis.$refs.canvasImage.appendChild(image)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\timage.src = fileBlobURL\r\n\r\n\t\t\tthis._imageNode = image\r\n\r\n\t\t\tevent.target.value = ''\r\n\t\t},\r\n\t\tmoveImage(event) {\r\n\t\t\tconst offsetTopStart = this.size.offsetTop\r\n\t\t\tconst offsetLeftStart = this.size.offsetLeft\r\n\t\t\tconst offsetLeftRange = (this.imageWidthInView - this.size.cropWidthInView) / 2\r\n\t\t\tconst offsetTopRange = (this.imageHeightInView - this.size.cropHeightInView) / 2\r\n\r\n\t\t\tdragHandle(event, {\r\n\t\t\t\tmove: ({ xOffset, yOffset }) => {\r\n\t\t\t\t\tlet newOffsetTop = offsetTopStart + yOffset\r\n\t\t\t\t\tlet newOffsetLeft = offsetLeftStart + xOffset\r\n\t\t\t\t\tthis.size.offsetTop = Math.max(Math.min(newOffsetTop, offsetTopRange), -offsetTopRange)\r\n\t\t\t\t\tthis.size.offsetLeft = Math.max(Math.min(newOffsetLeft, offsetLeftRange), -offsetLeftRange)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tupload() {\r\n\t\t\tthis.capture(({ fileBlob, config }) => {\r\n\t\t\t\tlet file = new File([fileBlob], 'capture.jpeg', { type: 'image/jpeg', lastModified: Date.now() })\r\n\t\t\t\tthis.$emit('confirm', {\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tfile,\r\n\t\t\t\t\tconfig\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\t\tcapture(callback) {\r\n\t\t\tlet canvas = document.createElement('canvas')\r\n\t\t\tcanvas.width = this.cropWidth\r\n\t\t\tcanvas.height = this.cropHeight\r\n\t\t\tlet zoomRate = this.cropWidth / this.size.cropWidthInView\r\n\t\t\tlet usedWidth = this.imageWidthInView * zoomRate\r\n\t\t\tlet usedHeight = this.imageHeightInView * zoomRate\r\n\t\t\tlet usedX = ((this.size.cropWidthInView - this.imageWidthInView) / 2 + this.size.offsetLeft) * zoomRate\r\n\t\t\tlet usedY = ((this.size.cropHeightInView - this.imageHeightInView) / 2 + this.size.offsetTop) * zoomRate\r\n\r\n\t\t\tcanvas.getContext('2d').drawImage(this._imageNode, usedX, usedY, usedWidth, usedHeight)\r\n\t\t\tcanvas.toBlob(fileBlob => {\r\n\t\t\t\tcallback && callback({\r\n\t\t\t\t\tfileBlob,\r\n\t\t\t\t\tconfig: {\r\n\t\t\t\t\t\tx: -usedX / usedWidth + 0,\r\n\t\t\t\t\t\ty: -usedY / usedHeight + 0,\r\n\t\t\t\t\t\twidth: this.cropWidth / usedWidth,\r\n\t\t\t\t\t\theight: this.cropHeight / usedHeight\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, 'image/jpeg', 0.95)\r\n\t\t}\r\n\t},\r\n\tbeforeDestroy: function () {\r\n\t}\r\n}\r\n\r\nexport default ImageFiller\r\n","import ImageFiller from './image-filler.js'\r\n\r\nImageFiller.install = function (Vue) {\r\n\tVue.component('ImageFiller', ImageFiller);\r\n}\r\nexport default ImageFiller\r\n"],"names":["preventDefault","event","window","getSelection","removeAllRanges","document","selection","empty","stopPropagation","stepCall","callback","startX","startY","clientX","clientY","xOffset","yOffset","touch","move","end","touches","lastTouch","touchmove","e","touchend","target","removeEventListener","addEventListener","mouse","mousemove","mouseup","dragHandle","type","Slider","name","props","min","Number","default","max","value","template","data","isDragging","computed","progressLocal","mounted","watch","methods","percentStart","sliderWidth","$refs","outer","clientWidth","newPercent","Math","newValue","$emit","beforeDestroy","getBoxSizePlaceIntoAnotherBox","innerWidth","innerHeight","outerWidth","outerHeight","width","height","ImageFiller","components","isFileSelected","_imageNode","size","scaleMin","scaleMax","scale","canvasWidth","canvasHeight","cropWidthInView","cropHeightInView","imageWidth","imageHeight","offsetTop","offsetLeft","cropWidth","cropHeight","imageWidthInView","imageHeightInView","offsetLeftRange","offsetTopRange","triggerFileSelect","uploadInput","dispatchEvent","MouseEvent","fileChangeHandle","file","files","fileBlobURL","URL","createObjectURL","Blob","image","Image","onload","naturalWidth","naturalHeight","$nextTick","canvasImage","innerHTML","appendChild","src","moveImage","offsetTopStart","offsetLeftStart","newOffsetTop","newOffsetLeft","upload","capture","fileBlob","config","File","lastModified","Date","now","canvas","createElement","zoomRate","usedWidth","usedHeight","usedX","usedY","getContext","drawImage","toBlob","x","y","install","Vue","component"],"mappings":"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"}